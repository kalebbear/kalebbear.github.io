(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5c46f2b8"],{"0a93":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"brands-container"},[t("el-card",{staticClass:"card"},[t("div",{staticClass:"title"},[e._v("【商品品牌管理】")]),t("div",{staticClass:"center"},[t("div",{staticClass:"search-bar"},[t("el-input",{staticClass:"search-input",attrs:{placeholder:"请输入品牌名称",clearable:""},model:{value:e.searchQuery,callback:function(t){e.searchQuery=t},expression:"searchQuery"}}),t("el-button",{staticClass:"search-button",attrs:{type:"primary"},on:{click:e.searchBrands}},[e._v("搜索")]),t("el-button",{staticClass:"search-button",attrs:{type:"success"},on:{click:e.showAddBrandDialog}},[e._v("新增品牌")])],1),t("el-table",{staticClass:"brand-table",staticStyle:{width:"100%"},attrs:{data:e.brands,stripe:""}},[t("el-table-column",{attrs:{prop:"name",sortable:"",label:"品牌名称"}}),t("el-table-column",{attrs:{prop:"description",sortable:"",label:"品牌描述"}}),t("el-table-column",{attrs:{label:"品牌Logo"},scopedSlots:e._u([{key:"default",fn:function(a){return[a.row.logo?t("el-image",{staticStyle:{width:"80px",height:"80px"},attrs:{src:a.row.logo,"preview-src-list":[a.row.logo]},on:{error:e.handleImageError}}):e._e()]}}])}),t("el-table-column",{attrs:{label:"操作",width:"160"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.editBrand(a.row)}}},[e._v("编辑")]),t("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(t){return e.confirmDeleteBrand(a.row)}}},[e._v("删除")])]}}])})],1),t("el-pagination",{staticClass:"pagination",attrs:{"current-page":e.currentPage,"page-size":e.pageSize,layout:"total, prev, pager, next",total:e.totalBrands},on:{"current-change":e.handlePageChange}})],1)]),t("el-dialog",{attrs:{title:"新增品牌",visible:e.addBrandDialogVisible},on:{"update:visible":function(t){e.addBrandDialogVisible=t}}},[t("el-form",{ref:"newBrandForm",attrs:{model:e.newBrand,rules:e.rules,"label-position":"top"}},[t("el-form-item",{attrs:{label:"品牌名称",prop:"name"}},[t("el-input",{model:{value:e.newBrand.name,callback:function(t){e.$set(e.newBrand,"name",t)},expression:"newBrand.name"}})],1),t("el-form-item",{attrs:{label:"品牌描述",prop:"description"}},[t("el-input",{attrs:{type:"textarea"},model:{value:e.newBrand.description,callback:function(t){e.$set(e.newBrand,"description",t)},expression:"newBrand.description"}})],1),t("el-form-item",{attrs:{label:"品牌Logo",prop:"logo"}},[t("el-input",{model:{value:e.newBrand.logo,callback:function(t){e.$set(e.newBrand,"logo",t)},expression:"newBrand.logo"}}),t("el-upload",{ref:"uploadLogo",staticClass:"upload-demo",attrs:{action:e.uploadUrl,"before-upload":e.beforeUploadLogo,"on-success":e.handleLogoUploadSuccess,"show-file-list":!1}},[t("el-button",{attrs:{size:"small",type:"primary"}},[e._v("上传图片")])],1)],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.addBrandDialogVisible=!1}}},[e._v("取消")]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("newBrandForm")}}},[e._v("确定")])],1)],1),t("el-dialog",{attrs:{title:"编辑品牌",visible:e.editBrandDialogVisible},on:{"update:visible":function(t){e.editBrandDialogVisible=t}}},[t("el-form",{ref:"editBrandForm",attrs:{model:e.currentBrand,rules:e.rules,"label-position":"top"}},[t("el-form-item",{attrs:{label:"品牌名称",prop:"name"}},[t("el-input",{model:{value:e.currentBrand.name,callback:function(t){e.$set(e.currentBrand,"name",t)},expression:"currentBrand.name"}})],1),t("el-form-item",{attrs:{label:"品牌描述",prop:"description"}},[t("el-input",{attrs:{type:"textarea"},model:{value:e.currentBrand.description,callback:function(t){e.$set(e.currentBrand,"description",t)},expression:"currentBrand.description"}})],1),t("el-form-item",{attrs:{label:"品牌Logo",prop:"logo"}},[t("el-input",{model:{value:e.currentBrand.logo,callback:function(t){e.$set(e.currentBrand,"logo",t)},expression:"currentBrand.logo"}}),t("el-upload",{ref:"uploadLogo",staticClass:"upload-demo",attrs:{action:e.uploadUrl,"before-upload":e.beforeUploadLogo,"on-success":e.handleLogoUploadSuccess,"show-file-list":!1}},[t("el-button",{attrs:{size:"small",type:"primary"}},[e._v("上传图片")])],1)],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.editBrandDialogVisible=!1}}},[e._v("取消")]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitEditForm("editBrandForm")}}},[e._v("确定")])],1)],1),t("el-dialog",{attrs:{title:"确认删除",visible:e.deleteBrandDialogVisible},on:{"update:visible":function(t){e.deleteBrandDialogVisible=t}}},[t("span",[e._v("你确定要删除这个品牌吗？")]),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.deleteBrandDialogVisible=!1}}},[e._v("取消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.deleteBrand}},[e._v("确定")])],1)]),t("el-dialog",{attrs:{visible:e.imageDialogVisible,width:"30%"},on:{"update:visible":function(t){e.imageDialogVisible=t}}},[t("img",{staticStyle:{width:"100%"},attrs:{src:e.currentImage}})])],1)},r=[],i=a("365c"),o=a("f121"),l={name:"Brands",data(){return{searchQuery:"",brands:[],currentPage:1,pageSize:10,totalBrands:0,addBrandDialogVisible:!1,editBrandDialogVisible:!1,deleteBrandDialogVisible:!1,newBrand:{name:"",description:"",logo:""},currentBrand:{},brandToDelete:null,rules:{name:[{required:!0,message:"请输入品牌名称",trigger:"blur"}],description:[{required:!0,message:"请输入品牌描述",trigger:"blur"}],logo:[{required:!0,message:"请输入品牌Logo",trigger:"blur"}]},uploadUrl:"/api/v1/fileUpload/upload",imageDialogVisible:!1,currentImage:""}},mounted(){this.fetchBrands()},methods:{async fetchBrands(){try{const e=await Object(i["m"])(this.currentPage-1,this.pageSize,"id");0===e.code?(this.brands=e.data,this.totalBrands=e.data.length):this.$message.error("获取品牌列表失败: "+e.message)}catch(e){this.$message.error("获取品牌列表失败: "+e.message)}},async searchBrands(){try{const e=await Object(i["u"])(this.searchQuery);0===e.code?(this.brands=e.data,this.totalBrands=e.data.length):this.$message.error("搜索品牌失败: "+e.message)}catch(e){this.$message.error("搜索品牌失败: "+e.message)}},handlePageChange(e){this.currentPage=e,this.fetchBrands()},showAddBrandDialog(){this.addBrandDialogVisible=!0},async addBrand(){try{const e=await Object(i["a"])(this.newBrand);0===e.code?(this.$message.success("新增品牌成功"),this.addBrandDialogVisible=!1,this.fetchBrands()):this.$message.error("新增品牌失败: "+e.message)}catch(e){this.$message.error("新增品牌失败: "+e.message)}},async editBrand(e){this.currentBrand={...e},this.editBrandDialogVisible=!0},async submitEditForm(e){this.$refs[e].validate(async e=>{if(e)try{const e=await Object(i["x"])(this.currentBrand);0===e.code?(this.$message.success("编辑品牌成功"),this.editBrandDialogVisible=!1,this.fetchBrands()):this.$message.error("编辑品牌失败: "+e.message)}catch(t){this.$message.error("编辑品牌失败: "+t.message)}else this.$message.error("请填写完整的品牌信息")})},confirmDeleteBrand(e){this.brandToDelete=e,this.deleteBrandDialogVisible=!0},async deleteBrand(){try{const e=await Object(i["f"])(this.brandToDelete.id);0===e.code?(this.$message.success("删除品牌成功"),this.deleteBrandDialogVisible=!1,this.fetchBrands()):this.$message.error("删除品牌失败: "+e.message)}catch(e){this.$message.error("删除品牌失败: "+e.message)}},submitForm(e){this.$refs[e].validate(e=>{e?this.addBrand():this.$message.error("请填写完整的品牌信息")})},handleLogoUploadSuccess(e){if(0===e.code){const t=`${o["a"]}/v1/getLatestImage?fileName=${e.data}`;this.addBrandDialogVisible?this.newBrand.logo=t:this.editBrandDialogVisible&&(this.currentBrand.logo=t),this.$message.success("图片上传成功")}else 401===e.code?this.$message.error("登录超时，请重新登录"):this.$message.error("图片上传失败: "+e.message)},beforeUploadLogo(e){const t=new FormData;return t.append("file",e),t.append("userId",window.localStorage.getItem("SET_NAME")),t.append("type","logo"),this.uploadFile(t),!1},async uploadFile(e){try{const t=await Object(i["C"])(e);this.handleLogoUploadSuccess(t)}catch(t){t.response&&401===t.response.status?this.$message.error("登录超时，请重新登录"):this.$message.error("图片上传失败: "+t.message)}},showImageDialog(e){this.currentImage=e,this.imageDialogVisible=!0}}},n=l,d=(a("8e03"),a("2877")),c=Object(d["a"])(n,s,r,!1,null,"d1417886",null);t["default"]=c.exports},"67c8":function(e,t,a){},"8e03":function(e,t,a){"use strict";a("67c8")}}]);
//# sourceMappingURL=chunk-5c46f2b8.9c5cd5ef.js.map