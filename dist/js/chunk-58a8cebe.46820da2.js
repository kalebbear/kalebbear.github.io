(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-58a8cebe"],{"4da6":function(e,t,i){"use strict";i("e9c4")},b90d:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"certificate-container"},[t("el-card",{staticClass:"card"},[t("div",{staticClass:"title"},[e._v("【品牌授权证书管理】")]),t("div",{staticClass:"center"},[t("div",{staticClass:"search-bar"},[t("el-input",{staticClass:"search-input",attrs:{placeholder:"请输入证书名称",clearable:""},model:{value:e.searchQuery,callback:function(t){e.searchQuery=t},expression:"searchQuery"}}),t("el-button",{staticClass:"search-button",attrs:{type:"primary"},on:{click:e.searchCertificates}},[e._v("搜索")]),t("el-button",{staticClass:"search-button",attrs:{type:"success"},on:{click:e.showAddCertificateDialog}},[e._v("新增证书")])],1),t("el-table",{staticClass:"certificate-table",staticStyle:{width:"100%"},attrs:{data:e.certificates,stripe:""}},[t("el-table-column",{attrs:{prop:"name",sortable:"",label:"证书名称"}}),t("el-table-column",{attrs:{prop:"description",sortable:"",label:"证书描述"}}),t("el-table-column",{attrs:{label:"证书图片"},scopedSlots:e._u([{key:"default",fn:function(i){return[i.row.imageUrl?t("el-image",{staticStyle:{width:"80px",height:"80px"},attrs:{src:i.row.imageUrl,"preview-src-list":[i.row.imageUrl]},on:{error:e.handleImageError}}):e._e()]}}])}),t("el-table-column",{attrs:{label:"操作",width:"160"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.editCertificate(i.row)}}},[e._v("编辑")]),t("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(t){return e.confirmDeleteCertificate(i.row)}}},[e._v("删除")])]}}])})],1),t("el-pagination",{staticClass:"pagination",attrs:{"current-page":e.currentPage,"page-size":e.pageSize,layout:"total, prev, pager, next",total:e.totalCertificates},on:{"current-change":e.handlePageChange}})],1)]),t("el-dialog",{attrs:{title:"新增证书",visible:e.addCertificateDialogVisible},on:{"update:visible":function(t){e.addCertificateDialogVisible=t}}},[t("el-form",{ref:"newCertificateForm",attrs:{model:e.newCertificate,rules:e.rules,"label-position":"top"}},[t("el-form-item",{attrs:{label:"证书名称",prop:"name"}},[t("el-input",{model:{value:e.newCertificate.name,callback:function(t){e.$set(e.newCertificate,"name",t)},expression:"newCertificate.name"}})],1),t("el-form-item",{attrs:{label:"证书描述",prop:"description"}},[t("el-input",{attrs:{type:"textarea"},model:{value:e.newCertificate.description,callback:function(t){e.$set(e.newCertificate,"description",t)},expression:"newCertificate.description"}})],1),t("el-form-item",{attrs:{label:"证书图片",prop:"imageUrl"}},[t("el-input",{model:{value:e.newCertificate.imageUrl,callback:function(t){e.$set(e.newCertificate,"imageUrl",t)},expression:"newCertificate.imageUrl"}}),t("el-upload",{ref:"uploadCertificate",staticClass:"upload-demo",attrs:{action:e.uploadUrl,"before-upload":e.beforeUploadCertificate,"on-success":e.handleCertificateUploadSuccess,"show-file-list":!1}},[t("el-button",{attrs:{size:"small",type:"primary"}},[e._v("上传图片")])],1)],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.addCertificateDialogVisible=!1}}},[e._v("取消")]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("newCertificateForm")}}},[e._v("确定")])],1)],1),t("el-dialog",{attrs:{title:"编辑证书",visible:e.editCertificateDialogVisible},on:{"update:visible":function(t){e.editCertificateDialogVisible=t}}},[t("el-form",{ref:"editCertificateForm",attrs:{model:e.currentCertificate,rules:e.rules,"label-position":"top"}},[t("el-form-item",{attrs:{label:"证书名称",prop:"name"}},[t("el-input",{model:{value:e.currentCertificate.name,callback:function(t){e.$set(e.currentCertificate,"name",t)},expression:"currentCertificate.name"}})],1),t("el-form-item",{attrs:{label:"证书描述",prop:"description"}},[t("el-input",{attrs:{type:"textarea"},model:{value:e.currentCertificate.description,callback:function(t){e.$set(e.currentCertificate,"description",t)},expression:"currentCertificate.description"}})],1),t("el-form-item",{attrs:{label:"证书图片",prop:"imageUrl"}},[t("el-input",{model:{value:e.currentCertificate.imageUrl,callback:function(t){e.$set(e.currentCertificate,"imageUrl",t)},expression:"currentCertificate.imageUrl"}}),t("el-upload",{ref:"uploadCertificate",staticClass:"upload-demo",attrs:{action:e.uploadUrl,"before-upload":e.beforeUploadCertificate,"on-success":e.handleCertificateUploadSuccess,"show-file-list":!1}},[t("el-button",{attrs:{size:"small",type:"primary"}},[e._v("上传图片")])],1)],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.editCertificateDialogVisible=!1}}},[e._v("取消")]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitEditForm("editCertificateForm")}}},[e._v("确定")])],1)],1),t("el-dialog",{attrs:{title:"确认删除",visible:e.deleteCertificateDialogVisible},on:{"update:visible":function(t){e.deleteCertificateDialogVisible=t}}},[t("span",[e._v("你确定要删除这个证书吗？")]),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.deleteCertificateDialogVisible=!1}}},[e._v("取消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.deleteCertificate}},[e._v("确定")])],1)]),t("el-dialog",{attrs:{visible:e.imageDialogVisible,width:"30%"},on:{"update:visible":function(t){e.imageDialogVisible=t}}},[t("img",{staticStyle:{width:"100%"},attrs:{src:e.currentImage}})])],1)},r=[],s=i("365c"),l=i("f121"),c={name:"BrandAuthorizationCertificate",data(){return{searchQuery:"",certificates:[],currentPage:1,pageSize:10,totalCertificates:0,addCertificateDialogVisible:!1,editCertificateDialogVisible:!1,deleteCertificateDialogVisible:!1,newCertificate:{name:"",description:"",imageUrl:""},currentCertificate:{name:"",description:"",imageUrl:""},certificateToDelete:null,rules:{name:[{required:!0,message:"请输入证书名称",trigger:"blur"}],description:[{required:!0,message:"请输入证书描述",trigger:"blur"}],imageUrl:[{required:!0,message:"请上传证书图片",trigger:"blur"}]},uploadUrl:"/api/v1/fileUpload/upload",imageDialogVisible:!1,currentImage:"",tableData:[]}},mounted(){this.fetchCertificates()},methods:{async fetchCertificates(){try{const e=await Object(s["n"])(this.currentPage-1,this.pageSize,"id");0===e.code?(this.certificates=e.data,this.totalCertificates=e.data.length):this.$message.error("获取证书列表失败: "+e.message)}catch(e){this.$message.error("获取证书列表失败: "+e.message)}},async searchCertificates(){try{const e=await Object(s["v"])(this.searchQuery);0===e.code?(this.certificates=e.data,this.totalCertificates=e.data.length):this.$message.error("搜索证书失败: "+e.message)}catch(e){this.$message.error("搜索证书失败: "+e.message)}},handlePageChange(e){this.currentPage=e,this.fetchCertificates()},showAddCertificateDialog(){this.addCertificateDialogVisible=!0},handleImageError(){this.$message.error("图片加载失败")},async addCertificate(){try{const e=await Object(s["d"])(this.newCertificate);0===e.code?(this.$message.success("新增证书成功"),this.addCertificateDialogVisible=!1,this.fetchCertificates()):this.$message.error("新增证书失败: "+e.message)}catch(e){this.$message.error("新增证书失败: "+e.message)}},async editCertificate(e){this.currentCertificate={...e},this.editCertificateDialogVisible=!0},async submitEditForm(e){this.$refs[e].validate(async e=>{if(e)try{const e=await Object(s["z"])(this.currentCertificate);0===e.code?(this.$message.success("编辑证书成功"),this.editCertificateDialogVisible=!1,this.fetchCertificates()):this.$message.error("编辑证书失败: "+e.message)}catch(t){this.$message.error("编辑证书失败: "+t.message)}else this.$message.error("请填写完整的证书信息")})},confirmDeleteCertificate(e){this.certificateToDelete=e,this.deleteCertificateDialogVisible=!0},async deleteCertificate(){try{const e=await Object(s["h"])(this.certificateToDelete.id);0===e.code?(this.$message.success("删除证书成功"),this.deleteCertificateDialogVisible=!1,this.fetchCertificates()):this.$message.error("删除证书失败: "+e.message)}catch(e){this.$message.error("删除证书失败: "+e.message)}},submitForm(e){this.$refs[e].validate(e=>{e?this.addCertificate():this.$message.error("请填写完整的证书信息")})},handleCertificateUploadSuccess(e){if(0===e.code){const t=`${l["a"]}/v1/getLatestImage?fileName=${e.data}`;this.addCertificateDialogVisible?this.$set(this.newCertificate,"imageUrl",t):this.editCertificateDialogVisible&&this.$set(this.currentCertificate,"imageUrl",t),this.$message.success("图片上传成功")}else 401===e.code?this.$message.error("登录超时，请重新登录"):this.$message.error("图片上传失败: "+e.message)},beforeUploadCertificate(e){const t=new FormData;return t.append("file",e),t.append("userId",window.localStorage.getItem("SET_NAME")),t.append("type","certificate"),this.uploadFile(t),!1},async uploadFile(e){try{const t=await Object(s["C"])(e);this.handleCertificateUploadSuccess(t)}catch(t){t.response&&401===t.response.status?this.$message.error("登录超时，请重新登录"):this.$message.error("图片上传失败: "+t.message)}},showImageDialog(e){this.currentImage=e,this.imageDialogVisible=!0}}},o=c,n=(i("4da6"),i("2877")),f=Object(n["a"])(o,a,r,!1,null,"ba04f798",null);t["default"]=f.exports},e9c4:function(e,t,i){}}]);
//# sourceMappingURL=chunk-58a8cebe.46820da2.js.map